{"ast":null,"code":"var _jsxFileName = \"/Users/huanghao/Desktop/Drawing Together/src/ReactCanvasPaint.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useCallback, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport styles from './index.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction DrawingToolBox({\n  colors,\n  active,\n  onChange\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.toolBoxContainer,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.colors,\n      children: colors.map((color, key) => /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => onChange(color),\n        className: classNames(styles.color, {\n          [styles.active]: active === color\n        }),\n        style: {\n          backgroundColor: color\n        }\n      }, key, false, {\n        fileName: _jsxFileName,\n        lineNumber: 11,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 9,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 8,\n    columnNumber: 5\n  }, this);\n}\n_c = DrawingToolBox;\nfunction ReactCanvasPaint(props) {\n  _s();\n  const canvas = useRef(null);\n  const [drawing, setDrawing] = useState(false);\n  const [position, setPosition] = useState(null);\n  const [activeColor, setActiveColor] = useState(props.colors ? props.colors[0] : 'white');\n  const onDown = useCallback(event => {\n    const coordinates = getCoordinates(event);\n    if (coordinates) {\n      setPosition(coordinates);\n      setDrawing(true);\n    }\n  }, []);\n  const onUp = useCallback(() => {\n    setDrawing(false);\n    setPosition(null);\n  }, []);\n  const getCoordinates = event => {\n    if (!canvas.current) {\n      return null;\n    }\n    const x = event.pageX || event.touches[0].pageX;\n    const y = event.pageY || event.touches[0].pageY;\n    return {\n      x: x - canvas.current.offsetLeft,\n      y: y - canvas.current.offsetTop\n    };\n  };\n  const onMove = useCallback(event => {\n    if (drawing) {\n      const newPosition = getCoordinates(event);\n      if (position && newPosition) {\n        drawLine(position, newPosition);\n        setPosition(newPosition);\n      }\n    }\n  }, [drawing, position]);\n  const drawLine = (originalPosition, newPosition) => {\n    if (!canvas.current) {\n      return null;\n    }\n    const context = canvas.current.getContext('2d');\n    if (context) {\n      context.strokeStyle = activeColor;\n      context.lineJoin = 'round';\n      context.lineWidth = props.strokeWidth;\n      context.beginPath();\n      context.moveTo(originalPosition.x, originalPosition.y);\n      context.lineTo(newPosition.x, newPosition.y);\n      context.closePath();\n      context.stroke();\n      handleDraw(context.getImageData(0, 0, props.width, props.height));\n    }\n  };\n  const handleDraw = data => {\n    if (typeof props.onDraw === 'function') {\n      props.onDraw(data);\n    }\n  };\n  useEffect(() => {\n    if (typeof props.data === 'object' && canvas.current) {\n      const context = canvas.current.getContext('2d');\n      // TODO: scale imageData\n      if (props.data === null) {\n        context.clearRect(0, 0, props.width, props.height);\n      } else {\n        context.putImageData(props.data, 0, 0);\n      }\n    }\n  }, [props.data]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvas,\n      onMouseDown: props.viewOnly ? undefined : onDown,\n      onTouchStart: props.viewOnly ? undefined : onDown,\n      onMouseUp: props.viewOnly ? undefined : onUp,\n      onTouchEnd: props.viewOnly ? undefined : onUp,\n      onMouseLeave: props.viewOnly ? undefined : onUp,\n      onMouseMove: props.viewOnly ? undefined : onMove,\n      onTouchMove: props.viewOnly ? undefined : onMove,\n      width: props.width,\n      height: props.height\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), !props.viewOnly && /*#__PURE__*/_jsxDEV(DrawingToolBox, {\n      colors: props.colors,\n      active: activeColor,\n      onChange: setActiveColor\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 5\n  }, this);\n}\n_s(ReactCanvasPaint, \"OKycIKP2xe3H50JG1x2U9wui2ew=\");\n_c2 = ReactCanvasPaint;\nReactCanvasPaint.propTypes = {\n  width: PropTypes.number,\n  height: PropTypes.number,\n  viewOnly: PropTypes.bool,\n  data: PropTypes.object,\n  onDraw: PropTypes.func,\n  colors: PropTypes.arrayOf(PropTypes.string),\n  strokeWidth: PropTypes.number\n};\nReactCanvasPaint.defaultProps = {\n  width: 400,\n  height: 400,\n  viewOnly: false,\n  data: undefined,\n  onDraw: undefined,\n  colors: ['#7030A2', '#000000', '#0170C1', '#FE0002', '#FFFF01', '#00AF52'],\n  strokeWidth: 5\n};\nexport default ReactCanvasPaint;\nvar _c, _c2;\n$RefreshReg$(_c, \"DrawingToolBox\");\n$RefreshReg$(_c2, \"ReactCanvasPaint\");","map":{"version":3,"names":["React","useRef","useState","useCallback","useEffect","PropTypes","classNames","styles","jsxDEV","_jsxDEV","DrawingToolBox","colors","active","onChange","className","toolBoxContainer","children","map","color","key","onClick","style","backgroundColor","fileName","_jsxFileName","lineNumber","columnNumber","_c","ReactCanvasPaint","props","_s","canvas","drawing","setDrawing","position","setPosition","activeColor","setActiveColor","onDown","event","coordinates","getCoordinates","onUp","current","x","pageX","touches","y","pageY","offsetLeft","offsetTop","onMove","newPosition","drawLine","originalPosition","context","getContext","strokeStyle","lineJoin","lineWidth","strokeWidth","beginPath","moveTo","lineTo","closePath","stroke","handleDraw","getImageData","width","height","data","onDraw","clearRect","putImageData","container","ref","onMouseDown","viewOnly","undefined","onTouchStart","onMouseUp","onTouchEnd","onMouseLeave","onMouseMove","onTouchMove","_c2","propTypes","number","bool","object","func","arrayOf","string","defaultProps","$RefreshReg$"],"sources":["/Users/huanghao/Desktop/Drawing Together/src/ReactCanvasPaint.js"],"sourcesContent":["import React, { useRef, useState, useCallback, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport styles from './index.css'\n\nfunction DrawingToolBox({ colors, active, onChange }) {\n  return (\n    <div className={styles.toolBoxContainer}>\n      <div className={styles.colors}>\n        {colors.map((color, key) => (\n          <button\n            key={key}\n            onClick={() => onChange(color)}\n            className={classNames(styles.color, {\n              [styles.active]: active === color\n            })}\n            style={{ backgroundColor: color }}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nfunction ReactCanvasPaint(props) {\n  const canvas = useRef(null)\n  const [drawing, setDrawing] = useState(false)\n  const [position, setPosition] = useState(null)\n  const [activeColor, setActiveColor] = useState(props.colors ? props.colors[0] : 'white')\n\n  const onDown = useCallback((event) => {\n    const coordinates = getCoordinates(event)\n    if (coordinates) {\n      setPosition(coordinates)\n      setDrawing(true)\n    }\n  }, [])\n\n  const onUp = useCallback(() => {\n    setDrawing(false)\n    setPosition(null)\n  }, [])\n\n  const getCoordinates = (event) => {\n    if (!canvas.current) {\n      return null\n    }\n\n    const x = event.pageX || event.touches[0].pageX\n    const y = event.pageY || event.touches[0].pageY\n\n    return {\n      x: x - canvas.current.offsetLeft,\n      y: y - canvas.current.offsetTop\n    }\n  }\n\n  const onMove = useCallback(\n    (event) => {\n      if (drawing) {\n        const newPosition = getCoordinates(event)\n        if (position && newPosition) {\n          drawLine(position, newPosition)\n          setPosition(newPosition)\n        }\n      }\n    },\n    [drawing, position]\n  )\n\n  const drawLine = (originalPosition, newPosition) => {\n    if (!canvas.current) {\n      return null\n    }\n\n    const context = canvas.current.getContext('2d')\n\n    if (context) {\n      context.strokeStyle = activeColor\n      context.lineJoin = 'round'\n      context.lineWidth = props.strokeWidth\n\n      context.beginPath()\n      context.moveTo(originalPosition.x, originalPosition.y)\n      context.lineTo(newPosition.x, newPosition.y)\n      context.closePath()\n\n      context.stroke()\n      handleDraw(context.getImageData(0, 0, props.width, props.height))\n    }\n  }\n\n  const handleDraw = (data) => {\n    if (typeof props.onDraw === 'function') {\n      props.onDraw(data)\n    }\n  }\n\n  useEffect(() => {\n    if (typeof props.data === 'object' && canvas.current) {\n      const context = canvas.current.getContext('2d')\n      // TODO: scale imageData\n      if (props.data === null) {\n        context.clearRect(0, 0, props.width, props.height)\n      } else {\n        context.putImageData(props.data, 0, 0)\n      }\n    }\n  }, [props.data])\n\n  return (\n    <div className={styles.container}>\n      <canvas\n        ref={canvas}\n        onMouseDown={props.viewOnly ? undefined : onDown}\n        onTouchStart={props.viewOnly ? undefined : onDown}\n        onMouseUp={props.viewOnly ? undefined : onUp}\n        onTouchEnd={props.viewOnly ? undefined : onUp}\n        onMouseLeave={props.viewOnly ? undefined : onUp}\n        onMouseMove={props.viewOnly ? undefined : onMove}\n        onTouchMove={props.viewOnly ? undefined : onMove}\n        width={props.width}\n        height={props.height}\n      />\n      {!props.viewOnly && (\n        <DrawingToolBox\n          colors={props.colors}\n          active={activeColor}\n          onChange={setActiveColor}\n        />\n      )}\n    </div>\n  )\n}\n\nReactCanvasPaint.propTypes = {\n  width: PropTypes.number,\n  height: PropTypes.number,\n  viewOnly: PropTypes.bool,\n  data: PropTypes.object,\n  onDraw: PropTypes.func,\n  colors: PropTypes.arrayOf(PropTypes.string),\n  strokeWidth: PropTypes.number\n}\n\nReactCanvasPaint.defaultProps = {\n  width: 400,\n  height: 400,\n  viewOnly: false,\n  data: undefined,\n  onDraw: undefined,\n  colors: ['#7030A2', '#000000', '#0170C1', '#FE0002', '#FFFF01', '#00AF52'],\n  strokeWidth: 5\n}\n\nexport default ReactCanvasPaint"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}